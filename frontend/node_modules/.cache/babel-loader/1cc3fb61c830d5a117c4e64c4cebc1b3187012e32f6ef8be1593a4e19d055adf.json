{"ast":null,"code":"var _jsxFileName = \"D:\\\\GesPerform\\\\frontend\\\\src\\\\Components\\\\ConfirmerPresence.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport Logo_one from '../img/timetable.png';\nimport { Link } from 'react-router-dom';\nimport '../CSS/confirmation.css';\nimport Spinner from './Spinner';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function ConfirmerPresence() {\n  _s();\n  let [loading, setLoading] = useState(false);\n  const [userMatricul, setMatricul] = useState(JSON.parse(localStorage.getItem('employee_detail')).num_matricul);\n  const [accMsg, setAccMsg] = useState('Veuillez marquer votre présence');\n  const [err, setErr] = useState(null);\n  const [latitude, setLatitude] = useState(null);\n  const [longitude, setLongitude] = useState(null);\n  const validerPresence = () => {\n    setLoading(true);\n    setAccMsg('Présence marquée');\n    fetch(`http://127.0.0.0.1:8000/api/getTimeStamp`, {\n      method: 'POST',\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        num_matricul: userMatricul\n      })\n    }).then(response => response.json()).then(data => {\n      console.log(data);\n      if (data.statut === 'ok') {\n        window.location.replace('./acceuilemployee');\n      }\n    });\n  };\n  const verifierLocalisation = distance => {\n    if (distance < 100) {\n      console.log('ok');\n      validerPresence();\n    } else {\n      console.log('come to office');\n      setErr('Rendez vous dans nos bureaux');\n      //setAccMsg('Veuillez vous rendre au bureau !');\n      setAccMsg('');\n    }\n    console.log(distance);\n  };\n  const Calcdistance = (lat1, lon1, lat2, lon2) => {\n    const R = 6371000;\n    const x = (lon2 - lon1) * Math.cos((lat1 + lat2) / 2);\n    const y = lat2 - lat1;\n    const d = Math.sqrt(x * x + y * y) * R;\n    return d;\n  };\n  useEffect(() => {\n    if ('geolocation' in navigator) {\n      navigator.geolocation.getCurrentPosition(position => {\n        // Obtenir les coordonnées de latitude et longitude\n        const {\n          latitude,\n          longitude\n        } = position.coords;\n        setLatitude(latitude);\n        setLongitude(longitude);\n\n        //console.log(position.coords);\n        verifierLocalisation(Calcdistance( /* longitude, latitude , */6.43212, 2.35092, 6.43212, 2.35092));\n      }, error => {\n        console.log('Erreur de géolocalisation :', error);\n      });\n    } else {\n      console.log('La géolocalisation n\\'est pas disponible dans ce navigateur.');\n    }\n\n    //autre fonction******************************************************************\n    setTimeout(() => {\n      setLoading(false);\n    }, 2800);\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"contain_confirmation\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"contain_header\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"contain_nav_confirm\",\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          style: {\n            textDecoration: 'none',\n            color: 'black'\n          },\n          to: \"/acceuilemployee\",\n          className: \"retour\",\n          children: \"Retour\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"contain_img_confirm\",\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: Logo_one,\n          className: \"img_confirm\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 16\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"contain_my_second_part\",\n      children: loading ? /*#__PURE__*/_jsxDEV(Spinner, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"\",\n        children: /*#__PURE__*/_jsxDEV(\"h4\", {\n          className: \"\",\n          children: [accMsg, err]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 97,\n    columnNumber: 5\n  }, this);\n}\n_s(ConfirmerPresence, \"jPrZbBAIoMkVrys96u4p/ZybhsQ=\");\n_c = ConfirmerPresence;\nvar _c;\n$RefreshReg$(_c, \"ConfirmerPresence\");","map":{"version":3,"names":["React","useEffect","useState","Logo_one","Link","Spinner","jsxDEV","_jsxDEV","ConfirmerPresence","_s","loading","setLoading","userMatricul","setMatricul","JSON","parse","localStorage","getItem","num_matricul","accMsg","setAccMsg","err","setErr","latitude","setLatitude","longitude","setLongitude","validerPresence","fetch","method","headers","body","stringify","then","response","json","data","console","log","statut","window","location","replace","verifierLocalisation","distance","Calcdistance","lat1","lon1","lat2","lon2","R","x","Math","cos","y","d","sqrt","navigator","geolocation","getCurrentPosition","position","coords","error","setTimeout","className","children","style","textDecoration","color","to","fileName","_jsxFileName","lineNumber","columnNumber","src","_c","$RefreshReg$"],"sources":["D:/GesPerform/frontend/src/Components/ConfirmerPresence.js"],"sourcesContent":["import React , {useEffect, useState} from 'react'\nimport Logo_one from '../img/timetable.png'\nimport { Link } from 'react-router-dom'\nimport '../CSS/confirmation.css'\nimport Spinner from './Spinner'\n\n\n\nexport default function ConfirmerPresence() {\n  let [loading, setLoading] = useState(false);\n  const [userMatricul , setMatricul] = useState(JSON.parse(localStorage.getItem('employee_detail')).num_matricul)\n  const [accMsg , setAccMsg] = useState('Veuillez marquer votre présence')\n\n  const [err , setErr] = useState(null)\n  const [latitude, setLatitude] = useState(null);\n  const [longitude, setLongitude] = useState(null);\n\n  const validerPresence = ()=>{\n    setLoading(true) ; \n    setAccMsg('Présence marquée')\n    fetch(`http://127.0.0.0.1:8000/api/getTimeStamp`, {\n      method: 'POST',\n      headers: {\n        'Accept':'application/json',\n        'Content-Type':'application/json'\n      },\n      body:JSON.stringify({\n        num_matricul: userMatricul , \n      }) \n     \n    })\n    .then(response => response.json())\n    .then((data) =>{\n      console.log(data)\n      if(data.statut === 'ok'){\n        window.location.replace('./acceuilemployee')\n      }\n    })\n    \n  }\n\n  const verifierLocalisation = (distance)=>{\n    if (distance < 100){\n      console.log('ok')\n      validerPresence();\n    }else{\n      console.log('come to office');\n      setErr('Rendez vous dans nos bureaux')\n      //setAccMsg('Veuillez vous rendre au bureau !');\n      setAccMsg('')\n    }\n   console.log(distance)\n  }\n\n  const Calcdistance = (lat1, lon1, lat2, lon2) => {\n    const R = 6371000;\n    const x = (lon2-lon1) * Math.cos((lat1+lat2)/2);\n    const y = (lat2-lat1);\n    const d = Math.sqrt(x*x + y*y) * R;\n    return d;\n  }\n\n\n  useEffect(()=>{\n   \n   \n\n    if ('geolocation' in navigator) {\n      navigator.geolocation.getCurrentPosition(\n        (position) => {\n          // Obtenir les coordonnées de latitude et longitude\n          const { latitude, longitude } = position.coords;\n          setLatitude(latitude);\n          setLongitude(longitude);\n\n          //console.log(position.coords);\n          verifierLocalisation(Calcdistance(/* longitude, latitude , */6.43212, 2.35092 ,  6.43212, 2.35092));\n  \n        },\n        (error) => {\n          console.log('Erreur de géolocalisation :', error);\n        }\n      );\n\n    } else {\n      console.log('La géolocalisation n\\'est pas disponible dans ce navigateur.');\n    }\n\n//autre fonction******************************************************************\n    setTimeout(()=>{\n      setLoading(false)\n    } , 2800)\n  }, [])\n\n\n  return (\n    <div className='contain_confirmation'>\n       \n        <div className='contain_header'>\n            <div className='contain_nav_confirm'>\n                \n              <Link style={{textDecoration:'none' , color:'black'}}  to='/acceuilemployee' className='retour' >\n                  Retour\n              </Link>\n        \n            </div>  \n\n            <div className='contain_img_confirm'>\n               <img  src={Logo_one} className='img_confirm'/>\n            </div>  \n        </div>\n\n\n        <div className='contain_my_second_part'>\n          {\n            loading?  \n            <Spinner\n          \n            />\n            :\n            <div className='' >\n                <h4 className=''>\n                  {accMsg}\n                  {err}\n                </h4>\n            </div>\n\n         }\n        </div>\n\n        \n\n    </div>\n  )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}